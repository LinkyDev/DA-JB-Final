This TSQL code works on AdventureWorks2019 database.